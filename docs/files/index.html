
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Async ODM for MongoDB.">
      
      
        <meta name="author" content="Gustavo F. Meneses Perez">
      
      
        <link rel="canonical" href="https://github.com/gurcuff91/mongotoy/docs/files/">
      
      
        <link rel="prev" href="../objects/">
      
      
        <link rel="next" href="../sync_mode/">
      
      
      <link rel="icon" href="../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>Files - Mongotoy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bucket" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mongotoy" class="md-header__button md-logo" aria-label="Mongotoy" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mongotoy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Files
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/gurcuff91/mongotoy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    gurcuff91/mongotoy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../quick_start/" class="md-tabs__link">
        
  
    
  
  Quick Start

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../documents/" class="md-tabs__link">
          
  
    
  
  Docs

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mongotoy" class="md-nav__button md-logo" aria-label="Mongotoy" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Mongotoy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gurcuff91/mongotoy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    gurcuff91/mongotoy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Files
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Files
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Bucket
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-a-bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Getting a bucket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-files" class="md-nav__link">
    <span class="md-ellipsis">
      Creating files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-revisions" class="md-nav__link">
    <span class="md-ellipsis">
      Search revisions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-existence" class="md-nav__link">
    <span class="md-ellipsis">
      File existence
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file" class="md-nav__link">
    <span class="md-ellipsis">
      File
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-revision" class="md-nav__link">
    <span class="md-ellipsis">
      Creating revision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Download contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Streaming contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-revision" class="md-nav__link">
    <span class="md-ellipsis">
      Getting a revision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-file" class="md-nav__link">
    <span class="md-ellipsis">
      Delete file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Streaming
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sync_mode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sync Mode
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Bucket
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-a-bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Getting a bucket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-files" class="md-nav__link">
    <span class="md-ellipsis">
      Creating files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-revisions" class="md-nav__link">
    <span class="md-ellipsis">
      Search revisions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-existence" class="md-nav__link">
    <span class="md-ellipsis">
      File existence
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file" class="md-nav__link">
    <span class="md-ellipsis">
      File
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-revision" class="md-nav__link">
    <span class="md-ellipsis">
      Creating revision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Download contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Streaming contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-revision" class="md-nav__link">
    <span class="md-ellipsis">
      Getting a revision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-file" class="md-nav__link">
    <span class="md-ellipsis">
      Delete file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Streaming
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Files</h1>

<style>
    .md-typeset h1{
        display: none;
    }
    .md-sidebar--primary {
        width: 8rem;
    }
</style>

<h2 id="bucket">Bucket</h2>
<p>The Bucket is a fundamental component for managing file storage within Mongotoy. Representing the default GridFS bucket
named <code>fs</code>, it offers a robust interface for seamless file operations. With functionalities including file search, 
uploads, existence checks, and access to revisions, the Bucket streamlines file management tasks. By ensuring 
consistency, reliability, and efficiency in handling file storage, it enhances the overall file management experience
within Mongotoy.</p>
<h3 id="getting-a-bucket">Getting a bucket</h3>
<p>Use the <code>session.fs()</code> method to obtain a Bucket object, which represents a 
<a href="https://www.mongodb.com/docs/manual/core/gridfs/">GridFS</a> bucket named <code>fs</code>. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Open db session</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c1"># Get a Bucket</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fs</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="creating-files">Creating files</h3>
<p>To create a file, you can invoke the <code>create()</code> method in the Bucket. With support for parameters like source, metadata,
and chunk size, this method provides flexibility and customization options, ensuring efficient file management.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Create an image file</span>
<span class="n">image</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;profile.jpeg&#39;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;profile.jpeg&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<h3 id="search-revisions">Search revisions</h3>
<p>You can effortlessly retrieve all <em>revisions</em> associated with a specific file stored in the file system bucket through 
the <code>revisions()</code> method in the Bucket. This method provides access to historical file versions, facilitating version 
control and supporting comprehensive file analysis.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get all revisions of profile.jpeg file</span>
<span class="n">revisions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">revisions</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;profile.jpeg&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="file-existence">File existence</h3>
<p>To verify the existence of files within the designated bucket, you can use the <code>exist()</code> method in the Bucket. This 
method offers a straightforward approach to checking file presence within the bucket, enhancing file management 
efficiency.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Check if profile.jpeg file exists</span>
<span class="n">exist</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">exist</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;profile.jpeg&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the Bucket class inherits from <a href="/gurcuff91/mongotoy/docs/objects">Objects</a>, it inherits all functionalities for 
filtering, sorting, and counting files.</p>
</div>
<h2 id="file">File</h2>
<p>Handling files in Mongotoy becomes effortless when you integrate the <code>mongotoy.types.File</code> into your document structure.
This simple step allows you to create a field representing a <a href="https://www.mongodb.com/docs/manual/core/gridfs/">GridFS</a>
object seamlessly. With the <code>mongotoy.types.File</code>, managing files within your Mongotoy documents becomes a breeze, 
enabling smooth storage and retrieval processes. This integration enhances the usability and flexibility of Mongotoy 
for you, empowering you to handle file-related operations with ease and confidence.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">mongotoy</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">mongotoy.types</span> <span class="kn">import</span> <span class="n">File</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">File</span>
</code></pre></div></td></tr></table></div>
<h3 id="creating-revision">Creating revision</h3>
<p>In Mongotoy, files are capable of having multiple revisions or versions, ensuring flexibility and version control within
your document storage. Creating a new revision of a file is a seamless process, as you can invoke the <code>create_revision()</code>
method in a <code>File</code> object.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Open db session</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c1"># Get a FsBucket</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fs</span><span class="p">()</span>

    <span class="c1"># Create a new revision of person image</span>
    <span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">create_revision</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;profile2.jpeg&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<h3 id="download-contents">Download contents</h3>
<p>To download the contents of files in Mongotoy, you can use the <code>download_to()</code> method available within a <code>File</code> object.
This method streamlines the process, allowing you to retrieve the file's contents effortlessly.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Open db session</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c1"># Get a FsBucket</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fs</span><span class="p">()</span>

    <span class="c1"># Download person image</span>
    <span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">download_to</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;profile3.jpeg&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<h3 id="streaming-contents">Streaming contents</h3>
<p>To stream file contents in Mongotoy, you can use the <code>stream()</code> method provided within a <code>File</code> object. This method
returns a <code>FieldStream</code> object, equipped with capabilities to seamlessly stream file contents. See <a href="#streaming">streaming</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Open db session</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c1"># Get a FsBucket</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fs</span><span class="p">()</span>

    <span class="c1"># Stream person image</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="getting-a-revision">Getting a revision</h3>
<p>You can effortlessly <a href="#download-contents">download</a> or <a href="#streaming-contents">stream</a> any revision of a file by 
indicating the <code>revision</code> parameter in the <code>download_to()</code> and <code>stream()</code> methods, respectively. This parameter, 
represented by an integer value, denotes the relationship with the upload date of the revision.</p>
<p>Here's how revision numbers are defined:</p>
<ul>
<li><strong>0</strong>: Represents the original stored file.</li>
<li><strong>1</strong>: Denotes the first revision.</li>
<li><strong>2</strong>: Signifies the second revision.</li>
<li><strong>-2</strong>: Refers to the second most recent revision.</li>
<li><strong>-1</strong>: Indicates the most recent revision.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="n">contents</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>

<span class="c1"># Download the original revision</span>
<span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">download_to</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">contents</span><span class="p">)</span>

<span class="c1"># Download first revision</span>
<span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">download_to</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">contents</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Download the most recent revision</span>
<span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">download_to</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">contents</span><span class="p">,</span> <span class="n">revision</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="delete-file">Delete file</h3>
<p>To delete a file from the database, you can invoke the <code>delete()</code> method available within a <code>File</code> object. 
This straightforward method facilitates the deletion process, ensuring efficient management of your database fields.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Open db session</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c1"># Get a FsBucket</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fs</span><span class="p">()</span>

    <span class="c1"># Delete person image</span>
    <span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When deleting documents, <em>file fields</em> within them do not trigger file deletion automatically. To remove files 
associated with documents, manual deletion is required using the <code>delete()</code> method within the <code>File</code> object.</p>
</div>
<h2 id="streaming">Streaming</h2>
<p>Streaming in Mongotoy enables efficient data retrieval from <a href="https://www.mongodb.com/docs/manual/core/gridfs/">GridFS</a>,
facilitating seamless access to large files stored in the database and improving performance by minimizing latency. By
allowing data to be read and processed in chunks, streaming reduces memory usage and enhances scalability. With built-in
support for streaming in <code>File</code> objects, you can integrate streaming functionality into tasks such as file uploads, 
downloads, and data processing. Overall, streaming in Mongotoy empowers users to effectively work with large datasets 
while optimizing performance and resource utilization.</p>
<p>The Streams in Mongotoy offers the following methods for efficient file data retrieval:</p>
<ul>
<li>
<p><strong>read(size = -1)</strong>: Read data from the file, allowing you to specify the number of bytes to read or read until 
the end of the file if not specified.</p>
</li>
<li>
<p><strong>readchunk()</strong>: Read a chunk of data from the file, providing you with chunk-based data retrieval.</p>
</li>
<li>
<p><strong>readline(size = -1)</strong>: Read a line from the file, with the option to specify the maximum number of bytes to
read or read until the end of the line if not specified.</p>
</li>
<li>
<p><strong>seek(pos, whence = os.SEEK_SET)</strong>: Moves the file pointer to a specified position, with options to 
specify the reference point for the seek operation.</p>
</li>
<li>
<p><strong>seekable()</strong>: Checks if the file is seekable, returning True if the file is seekable and False otherwise.</p>
</li>
<li>
<p><strong>tell()</strong>: Returns the current position of the file pointer, providing users with information about the current 
reading position within the file.</p>
</li>
<li>
<p><strong>close()</strong>: Closes the stream, ensuring proper resource management and cleanup.</p>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get the stream</span>
<span class="n">stream</span> <span class="o">=</span> <span class="k">await</span> <span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># Read all contents</span>
<span class="n">contents</span> <span class="o">=</span> <span class="k">await</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Seek to position 0</span>
<span class="n">stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Read by chunks</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">chunks</span><span class="p">):</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="k">await</span> <span class="n">stream</span><span class="o">.</span><span class="n">readchunk</span><span class="p">()</span>

<span class="c1"># Close stream</span>
<span class="n">stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tabs", "navigation.indexes", "search.suggest", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
    
  </body>
</html>